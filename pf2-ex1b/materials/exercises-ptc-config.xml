<proxy>

    <!-- The simplest pipe definition -->
    <pipe name="simplestPipe"/>

    <!-- Transform RSS feed to HTML using the built-in XSLTTransformer -->
    <pipe name="rssPipe">
        <response-transform>
            <transform class="com.backbase.portal.ptc.transform.response.impl.XSLTTransformer">
                <param name="xsltFile" value="/WEB-INF/xslt/rss/rss2xhtml.xsl" />
                <param name="cacheXSLFile" value="false" />
            </transform>
            <transform class="com.backbase.portal.ptc.transform.response.impl.ContentTypeResponseTransformer">
                <param name="contentType" value="text/html"/>
            </transform>
        </response-transform>
    </pipe>

    <!-- The properties data provider -->
    <data-provider class="com.backbase.exercises.ptc.dataproviders.PropertiesDataProvider" id="propertiesDataProvider" />
    <pipe name="propertiesPipe">
        <data-provider referenceId="propertiesDataProvider" />
    </pipe>
    <pipe name="propertiesPipe2">
        <data-provider referenceId="propertiesDataProvider" />
        <response-transform matchStatusCode="200-299">
            <transform class="com.backbase.exercises.ptc.transformers.PropertiesResponseTransformer" />
        </response-transform>
    </pipe>

    <!-- The stock data provider -->
    <data-provider class="com.backbase.exercises.ptc.dataproviders.RandomStockInfoDataProvider" id="randomStockInfoDataProvider"/>
    <!-- Get stock information and transform to a HTML table fragment -->
    <pipe name="xmlStockInfoPipe">
        <data-provider referenceId="randomStockInfoDataProvider"/>
    </pipe>
    <pipe name="xmlStockInfoPipe2">
        <data-provider referenceId="randomStockInfoDataProvider"/>
        <response-transform>
            <transform class="com.backbase.portal.ptc.transform.response.impl.XSLTTransformer">
                <param name="xsltFile" value="/WEB-INF/xslt/stocks/stocks.xslt"/>
                <param name="cacheXSLFile" value="true"/>
            </transform>
        </response-transform>
    </pipe>
    <pipe name="xmlStockInfoPipe3">
        <data-provider referenceId="randomStockInfoDataProvider"/>
        <response-transform>
            <transform class="com.backbase.portal.ptc.transform.response.impl.XSLTTransformer">
                <param name="xsltFile" value="/WEB-INF/xslt/stocks/stocks.xslt"/>
                <param name="cacheXSLFile" value="true"/>
            </transform>
            <transform class="com.backbase.portal.ptc.transform.response.impl.ContentTypeResponseTransformer">
                <param name="contentType" value="text/html"/>
            </transform>
        </response-transform>
    </pipe>
    <pipe name="jsonStockInfoPipe">
        <data-provider referenceId="randomStockInfoDataProvider"/>
        <response-transform matchStatusCode="200-299">
            <transform class="com.backbase.exercises.ptc.transformers.Xml2JSONResponseTransformer"/>
        </response-transform>
    </pipe>
    <pipe name="jsonStockInfoPipe2">
        <data-provider referenceId="randomStockInfoDataProvider"/>
        <response-transform matchStatusCode="200-299">
            <transform class="com.backbase.exercises.ptc.transformers.Xml2JSONResponseTransformer">
                <param name="wrap" value="true"/>
                <param name="objectName" value="stocks"/>
            </transform>
        </response-transform>
    </pipe>
    <!-- Static XML to JSON pipe. Please use the 'url' attribute to call this pipe -->
    <!-- http://localhost:7777/portalserver/proxy?pipe=jsonPipe&url=http://localhost:7777/portalserver/proxy?pipe=xmlStockInfoPipe -->
    <pipe name="jsonPipe">
        <response-transform>
            <transform class="com.backbase.exercises.ptc.transformers.Xml2JSONResponseTransformer"/>
        </response-transform>
    </pipe>

    <!-- The currency rates data provider -->
    <data-provider class="com.backbase.exercises.ptc.dataproviders.CMISDataProvider" id="cmisDataProvider">
        <param name="user" value="admin" />
        <param name="password" value="admin" />
        <param name="repository" value="contentRepository" />
        <param name="repositoryURL" value="http://localhost:7778/contentservices/atom" />
        <param name="documentID" value="id-of-the-cmis:document-created-in-the-myfeeds-folder-of-the-content-repository" />
    </data-provider>
    <pipe name="currencyRatesPipe">
        <data-provider referenceId="cmisDataProvider"/>
    </pipe>
    <pipe name="currencyRatesPipe2">
        <data-provider referenceId="cmisDataProvider"/>
        <response-transform matchStatusCode="200-299">
            <transform class="com.backbase.portal.ptc.transform.response.impl.XSLTTransformer">
                <param name="xsltFile" value="/WEB-INF/xslt/currencies/currencies.xsl"/>
                <param name="cacheXSLFile" value="false"/>
                <param name="selectedCurrencies">
                    <value>USD</value>
                    <value>EUR</value>
                    <value>GBP</value>
                    <value>CHF</value>
                    <value>JPY</value>
                    <value>CAD</value>
                    <value>AUD</value>
                </param>
            </transform>
            <transform class="com.backbase.portal.ptc.transform.response.impl.ContentTypeResponseTransformer">
                <param name="contentType" value="text/html"/>
            </transform>
        </response-transform>
    </pipe>

    <!-- Weather data provider, invoke with e.g. http://localhost:7777/portalserver/proxy?pipe=weatherPipe&zip=94102 -->
    <data-provider id="weatherDataProvider" class="com.backbase.exercises.ptc.dataproviders.WeatherDataProvider" />
    <pipe name="weatherPipe">
        <data-provider referenceId="weatherDataProvider" />
    </pipe>

</proxy>